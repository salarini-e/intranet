{% extends 'template.html' %}
{% load custom %}
{% load custom_filters %}	
{% block visao %}active{% endblock %}
{% block main %}   

				<!-- Owl Carousel CSS -->
				<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
				<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">
				<style>
					
					.owl-carousel .item {
					  background: #4a90e2;
					  color: white;
					  text-align: center;
					  font-size: 18px;
					  width: 100% !important;
					  height: auto;
					  border-radius: 10px;
					}
					.owl-carousel .owl-item{
						opacity: 20%;
					}
					.owl-carousel .center {
						opacity: 200% !important;
						
					}
					@media (min-width: 1400px) {
						.container-xxl, .container-xl, .container-lg, .container-md, .container-sm, .container {
							max-width: 1550px;
						}
					}
				  </style>
			
				<!-- Owl Carousel JS -->
				<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
				<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
				<script>
					$(document).ready(function(){
					  $(".owl-carousel").owlCarousel({
						center: true,
						items: 3,
						loop: true,
						margin: 10,
						autoplay: true,         // Ativa a reprodução automática
						autoplayTimeout: 5000,  // Define o tempo entre as transições (5 segundos)
						autoplayHoverPause: true, // Pausa o autoplay ao passar o mouse
						responsive: {
						  0: {
							items: 1
						  },
						  600: {
							items: 1
						  },
						  1000: {
							items: 1.5
						  }
						}
					  });
					});
				  </script>
			    <!-- <h1 class="app-page-title">Bem vindo, servidor!</h1>			     -->
			    <!-- <div class="app-card alert alert-dismissible shadow-sm mb-4 border-left-decoration" role="alert">
				    <div class="inner">
					    <div class="app-card-body p-3 p-lg-4">
						    <h3 class="mb-3">Bem-vindo, servidor!</h3>
						    <div class="row gx-5 gy-3">
						        <div class="col-12 col-lg-9">							        
							        <div>Nossa intranet é a ferramenta essencial para colaboração e eficiência no serviço público. Aqui, os servidores encontram recursos e informações para melhor desempenho de suas funções.</div>
							    </div>							    
						    </div>
						    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
					    </div>					    
				    </div>
			    </div> -->
				
				<style>
					.text-justify{
						text-align: justify;
					}	
				</style>
				<h1 class="mb-3">Bem vindo, servidor!</h1>			
				<div class="row pb-4">
					<div class="col pb-4">
						<div class="w-100 owl-carousel owl-theme">
							{% for item in carrousel %}
							<div class="item" style="background-image: url('{{item.imagem.url}}'); background-size: cover;">
								<a href="{{item.link}}">
									<img src="{{item.imagem.url}}" style="opacity: 0;" alt="{{item.alt}}">
								</a>
							</div>
							{% endfor %}								
						</div>
					</div>
				</div>								
				<div class="mb-5">
					
				<div id="mainNoticias" class="pt-2 pe-4 row g-4 app-card">
					
				    <div class="col-12 col-lg-6">
				        <div class="pe-5 ps-4 pb-3 h-100">
							<h3 class="mb-4">Últimas Notificações</h3>
							{% if notifications %}							
								{% for notification in notifications %}
								<a class="w-100" style="height: auto !important;" href="{{ notification.link }}">
									<div class="py-2" style="width: 100%; height: auto; text-align: center; background-color: #4ae2630e !important; color: #5e667a;">
										{% if "fa-" in notification.icone %}
										<i class="{{ notification.icone }} text-xl me-2"></i>
										{% else %}
										<img class="w-10 h-10 rounded-full me-2" src="{{ notification.icone }}" alt="Ícone">
										{% endif %}
										{{ notification.msg|safe }}
									</div>
								</a><br>
								{% endfor %}	
							{% endif %}
							<p class="text-justify mx-3">
								A Intranet é o nosso espaço exclusivo de comunicação interna, pensado para facilitar o acesso a informações, recursos e novidades sobre a organização. Aqui, você pode acompanhar as notícias mais recentes, conferir os documentos importantes e se conectar com outras áreas e equipes.
							</p>
								<!-- Explore nossos conteúdos e fique por dentro de tudo o que acontece. Este é o lugar onde a colaboração se transforma em resultados e onde o trabalho em equipe é fortalecido a cada clique.
							</p> -->
							<!-- <button class="btn btn-primary text-white">
								Lorem ipsum
							</button> -->
				        </div>
			        </div>					
					<div class="col">
						<div class="row">
							<h3 class="mb-3">Notícias em Destaque</h3>
							{% for destaque in destaques %}
							<div class="col-lg-6 col-md-5 col-sm-12 mb-4 destaques">
								<a href="#" class="app-card app-card-progress-list h-100 shadow-sm">
									<img src="{{destaque.imagem_capa.url}}" class="img-fluid" alt="{{destaque.alt_capa}}" style="border-radius: 10px;">
								</a>
							</div>
							{% endfor %}
						</div>
						
					</div>
				</div>
					<div class="row app-card">
						<div class="col">
							<hr>
							<h3 class="py-2 px-3">Últimas Notícias</h3>
							{% for noticia in noticias %}
							
							<div class="row mt-4">
								<a href="{% url 'noticias:detalhe' noticia.id %}" class="col-lg-4 col-sm-12 d-flex flex-column d-flex">							
									<img src="{{noticia.imagem_capa.url}}" class="m-auto img-fluid" alt="{{noticia.alt_capa}}" style="border-radius: 10px;">									
								</a>
								<div class="col d-flex flex-column pe-5">
									<p style="font-size: 20pt; line-height: auto; color: #1b1b1b !important;" class="mt-1 mb-0 pb-0">
										<strong class="my-0 py-0">{{noticia.titulo}}</strong>
									</p>
									<p style="line-height: auto;" class="my-0 py-0">
										<span class="my-0 py-0" style="font-size: 8pt;">{{noticia.dt_inclusao|date:"d/m/y	"}}</span>										
									</p>
									<p class="text-justify">
										{{noticia.resumo}}	
									</p>
									<a href="{% url 'noticias:detalhe' noticia.id %}" >
										Ler mais
									</a>
								</div>
							</div>
							
							{% endfor %}
							<button class="mt-4 mb-3 btn w-100 btn-primary text-white">
								ver mais
							</button>
						</div>
						
					</div>					
			  
				<script src="/static/plugins/chart.js/chart.min.js"></script> 
<script>
    'use strict';

	window.chartColors = {
	green: '#75c181',
	gray: '#a9b5c9',
	text: '#252930',
	border: '#e7e9ed'
};

// Dados de chamados

var semanas = {{ semanas|safe }};
var dados_abertos = {{ dados_abertos|safe }};
var dados_fechados = {{ dados_fechados|safe }};


var count_abertos = {{ count_abertos }};
var count_fechados = {{ count_fechados }};

// Dados para o gráfico de barras
var chamados_por_tipo = {{ chamados_por_tipo|safe }};

// Chart.js Line Chart Example
var lineChartConfig = {
	type: 'line',

	data: {
		labels: semanas,

		datasets: [{
                label: 'Chamados Abertos',
                fill: false,
                backgroundColor: window.chartColors.green,
                borderColor: window.chartColors.green,
                data: dados_abertos
            }, {
                label: 'Chamados Fechados',
                fill: false,
                backgroundColor: window.chartColors.gray,
                borderColor: window.chartColors.gray,
                data: dados_fechados
            }]
	},
	options: {
		responsive: true,
		aspectRatio: 1.5,

		legend: {
			display: true,
			position: 'bottom',
			align: 'end',
		},

		title: {
			display: false,
			text: 'Quantidade de Chamados',
		},
		tooltips: {
			mode: 'index',
			intersect: false,
			titleMarginBottom: 10,
			bodySpacing: 10,
			xPadding: 16,
			yPadding: 16,
			borderColor: window.chartColors.border,
			borderWidth: 1,
			backgroundColor: '#fff',
			bodyFontColor: window.chartColors.text,
			titleFontColor: window.chartColors.text,

			callbacks: {
				label: function(tooltipItem, data) {
					return tooltipItem.yLabel;
				}
			},

		},
		hover: {
			mode: 'nearest',
			intersect: true
		},
		scales: {
			xAxes: [{
				display: true,
				gridLines: {
					drawBorder: false,
					color: window.chartColors.border,
				},
				scaleLabel: {
					display: false,
				}
			}],
			yAxes: [{
				display: true,
				gridLines: {
					drawBorder: false,
					color: window.chartColors.border,
				},
				scaleLabel: {
					display: false,
				},
				ticks: {
					beginAtZero: true,
					userCallback: function(value, index, values) {
						return value;
					}
				},
			}]
		}
	}
};

// Chart.js Bar Chart Example
var barChartData = {
	labels: chamados_por_tipo.map(function(item) { return item.tipo; }),
	datasets: [{
		label: 'Quantidade de Chamados por Tipo',
		backgroundColor: window.chartColors.green,
		borderColor: window.chartColors.green,
		borderWidth: 1,
		data: chamados_por_tipo.map(function(item) { return item.quantidade; })
	}]
};

var barChartConfig = {
	type: 'bar',
	data: barChartData,
	options: {
		responsive: true,
		aspectRatio: 1.5,

		legend: {
			display: true,
			position: 'bottom',
			align: 'end',
		},

		title: {
			display: false,
			text: 'Quantidade de Chamados por Tipo',
		},
		tooltips: {
			mode: 'index',
			intersect: false,
			titleMarginBottom: 10,
			bodySpacing: 10,
			xPadding: 16,
			yPadding: 16,
			borderColor: window.chartColors.border,
			borderWidth: 1,
			backgroundColor: '#fff',
			bodyFontColor: window.chartColors.text,
			titleFontColor: window.chartColors.text,

			callbacks: {
				label: function(tooltipItem, data) {
					return tooltipItem.yLabel;
				}
			},

		},
		hover: {
			mode: 'nearest',
			intersect: true
		},
		scales: {
			xAxes: [{
				display: true,
				gridLines: {
					drawBorder: false,
					color: window.chartColors.border,
				},
				scaleLabel: {
					display: false,
				}
			}],
			yAxes: [{
				display: true,
				gridLines: {
					drawBorder: false,
					color: window.chartColors.border,
				},
				scaleLabel: {
					display: false,
				},
				ticks: {
					beginAtZero: true,
					userCallback: function(value, index, values) {
						return value;
					}
				},
			}]
		}
	}
};




// Generate charts on load
window.addEventListener('load', function(){
	
	var lineChart = document.getElementById('canvas-linechart').getContext('2d');
	window.myLine = new Chart(lineChart, lineChartConfig);
	
	var barChart = document.getElementById('canvas-barchart').getContext('2d');
	window.myBar = new Chart(barChart, barChartConfig);
	

});	
	

</script>
{% endblock %}