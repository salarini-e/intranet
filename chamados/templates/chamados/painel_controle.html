{% extends 'template_chamados.html' %}
{% block visao %}active{% endblock %}
{% block css %}
{% load static %}
<link rel="stylesheet" href="/static/css/painelControle.css">
{% endblock %}
{% block main %}   
				<div class="row" style="margin-bottom: 1.5rem;">
					<div class="col d-flex" style="display: flex;align-items: center;">
						<h1 class="app-page-title" style="margin-bottom: 0px;">Painel de controle</h1>
						<a href="/" class="ms-auto me-1 my-auto btn app-btn-secondary"><i class="fa-solid fa-rotate-left me-2"></i>Voltar</a>
					</div>
				</div>
			    
			    
			    <!-- <div class="app-card alert alert-dismissible shadow-sm mb-4 border-left-decoration" role="alert">
				    <div class="inner">
					    <div class="app-card-body p-3 p-lg-4">
						    <h3 class="mb-3">Bem-vindo, servidor!</h3>
						    <div class="row gx-5 gy-3">
						        <div class="col-12 col-lg-9">
							        
							        <div>Nossa intranet é a ferramenta essencial para colaboração e eficiência no serviço público. Aqui, os servidores encontram recursos e informações para melhor desempenho de suas funções.</div>
							    </div>
							   
						    </div>
						    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
					    </div>
					    
				    </div>
			    </div> -->
                <!-- <div class="row g-4 mb-4">
                    <div class="col">
                        <iframe src="https://stats.uptimerobot.com/GEM1QCB9XE" frameborder="0"></iframe>
                    </div>
                </div>  -->

				<!-- DESCOMENTAR -->
				<div class="row g-4 mb-4">
				    <div class="col-6 col-lg-3">
					    <div class="app-card app-card-stat shadow-sm h-100">
						    <div class="app-card-body p-3 p-lg-4">
							    <h4 class="stats-type mb-1">Total <i class="fa-solid fa-globe ms-2 text-success"></i></h4>
							    <div class="stats-figure">{{total_chamados}}</div>
							    <div class="stats-meta text-success">
								    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-up" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>
                                    </svg> 20%
									
								</div>
						    </div>
							{% if request.user.is_superuser or is_atendente%}
						    <a class="app-card-link-mask" href="{% url 'chamados:tickets' %}" target="_blank"></a>
							{% endif %}
					    </div>
				    </div>
				    
				    <div class="col-6 col-lg-3">
					    <div class="app-card app-card-stat shadow-sm h-100">
						    <div class="app-card-body p-3 p-lg-4">
							    <h4 class="stats-type mb-1">Abertos<i class="fa-solid fa-calendar-day ms-2 text-success"></i></h4>
							    <div class="stats-figure">{{chamados_abertos_30dias}}</div>
							    <div class="stats-meta" style="display: flex; flex-direction: column;">
									nos últimos 30 dias
								     <div>
										<div>
											{% if aumento_chamados_abertos_30_dias %}
												<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-down text-success" fill="currentColor"  style="transform: rotate(180deg);" xmlns="http://www.w3.org/2000/svg">
													<path fill-rule="evenodd" d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z"/>
												</svg>
											{% else %}
												<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-down text-damger" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
													<path fill-rule="evenodd" d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z"/>
												</svg>
											{% endif %}
											{{variacao_30_a_60_dias}}% 
										</div>   
											 
									</div>  
								</div> 
						    </div>
							{% if request.user.is_superuser or is_atendente%}
						    <a class="app-card-link-mask" href="{% url 'chamados:tickets' %}?status=0&ultimos_30_dias=True" target="_blank"></a>
							{% endif %}
					    </div>
				    </div>
				    <div class="col-6 col-lg-3">
					    <div class="app-card app-card-stat shadow-sm h-100">
						    <div class="app-card-body p-3 p-lg-4">
							    <h4 class="stats-type mb-1">Finalizados <i class="fa-solid fa-square-check ms-2 text-success"></i> </h4>
							    <div class="stats-figure">{{chamados_finalizados_30dias}}</div>
							    <div class="stats-meta">
									nos últimos 30 dias
								</div>
						    </div>
							{% if request.user.is_superuser or is_atendente%}
						    <a class="app-card-link-mask" href="{% url 'chamados:tickets' %}?status=4" target="_blank"></a>
							{% endif %}
					    </div>
				    </div>
				    <div class="col-6 col-lg-3">
					    <div class="app-card app-card-stat shadow-sm h-100">
						    <div class="app-card-body p-3 p-lg-4">
							    <h4 class="stats-type mb-1">Média diária <i class="fa-solid fa-gauge ms-2 text-success"></i></h4>
							    <div class="stats-figure">{{media_diaria}}</div>
							    <div class="stats-meta">chamados/dia</div>
						    </div>
						    <a class="app-card-link-mask" href="#"></a>
					    </div>
				    </div>
			    </div>
				
				<div class="row g-4 mb-4">
						<!-- Não atribuído -->
						<div class="col-6 col-lg-3">
							<div class="app-card app-card-stat shadow-sm h-100">
								<div class="app-card-body p-3 p-lg-4">
									<h4 class="stats-type mb-1">Não atribuído <i class="fa-solid fa-user-xmark ms-2 text-success"></i></h4>
									<div class="stats-figure">
										{{total_nao_atribuidos}}
									</div>
									<div class="stats-meta text-success">
										<!-- <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-up" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
											<path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>
										</svg>  -->
										{{porcentagem_nao_atribuidos}}%
									</div>
								</div>
								{% if request.user.is_superuser or is_atendente%}
								<a class="app-card-link-mask" href="{% url 'chamados:tickets' %}?profissional_designado__isnull=True" target="_blank"></a>
								{% endif %}
							</div>
						</div>
					<!-- NÃO RESOLVIDO -->
					<div class="col-6 col-lg-3">
						<div class="app-card app-card-stat shadow-sm h-100">
							<div class="app-card-body p-3 p-lg-4">
								<h4 class="stats-type mb-1">Não resolvido<i class="fa-solid fa-circle-exclamation ms-2 text-danger"></i></h4>
								<div class="stats-figure">
									{{total_nao_resolvidos}}
								</div>
								<div class="stats-meta text-danger">
									<!-- <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-up" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
										<path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>
									</svg>  -->
									{{porcentagem_nao_resolvidos}}%
								</div>
							</div>
							{% if request.user.is_superuser or is_atendente%}
							<a class="app-card-link-mask" href="{% url 'chamados:tickets' %}?nao_resolvidos=True" target="_blank"></a>
							{% endif %}
						</div>
					</div>
				</div>
					
				{% if request.user.is_superuser %}
				<!-- TICKETS NÃO RESOLVIDOS -->
				<div class="infos-tickets-abertos">
					<div class="infos-tickets-abertos-header">
						<h4 class="infos-tickets-abertos-header-title">Tickets não resolvidos</h4>
						<a href="{% url 'chamados:detalhesTicketsNaoResolvidos' %}" class="infos-tickets-abertos-header-link">
							Exibir detalhes
						</a>
					</div>
					<div class="infos-tickets-abertos-title">
							<span class="title-grupos">Grupo</span>
							<span class="title-status">Aberto</span>
					</div>
					{% for tipo, quantidade in chamados_abertos_por_tipo.items %}
					<div class="infos-tickets-abertos-content">
						<div class="infos-tickets-abertos-content-infos">
							<span class="infos-tickets-abertos-content-tipo">{{tipo}}</span>
							<span class="infos-tickets-abertos-content-number">{{ quantidade }}</span>
						</div>
					</div>
					{% endfor %}
					
				</div>

				{% endif %}


			    <div class="row g-4 mb-4">
			        <div class="col-12 col-lg-6">
				        <div class="app-card app-card-chart h-100 shadow-sm">
					        <div class="app-card-header p-3">
						        <div class="row justify-content-between align-items-center">
							        <div class="col-auto">
						                <h4 class="app-card-title">Chamados abertos</h4>
							        </div>
						        </div>
					        </div>
					        <div class="app-card-body p-3 p-lg-4">
							    <div class="mb-3 d-flex">   
							        <select class="form-select form-select-sm ms-auto d-inline-flex w-auto" id="period-select">
									    <option value="1">Hoje</option>
									    <option value="2"selected>Esta semana</option>
									    <option value="3">Este mês</option>
									    <option value="4">Este ano</option>
									    <option value="5">Último ano</option>
									</select>
							    </div>
						        <div class="chart-container">
				                    <canvas id="canvas-linechart-chamados" ></canvas>
						        </div>
					        </div>
				        </div>
			        </div>
			        <div class="col-12 col-lg-6">
				        <div class="app-card app-card-chart h-100 shadow-sm">
					        <div class="app-card-header p-3">
						        <div class="row justify-content-between align-items-center">
							        <div class="col-auto">
						                <h4 class="app-card-title">Por tipo </h4>
							        </div>
							        <div class="col-auto">
								        <div class="card-header-action">
									        <a href="charts.html">More charts</a>
								        </div>
							        </div>
						        </div>
					        </div>
					        <div class="app-card-body p-3 p-lg-4">
								comentar essa div
							    <div class="mb-3 d-flex">   
							        <select class="form-select form-select-sm ms-auto d-inline-flex w-auto">
									    <option value="1" selected>This week</option>
									    <option value="2">Today</option>
									    <option value="3">This Month</option>
									    <option value="3">This Year</option>
									</select>
							    </div>
						        <div class="chart-container">
				                    <canvas id="canvas-barchart" ></canvas>
						        </div>
					        </div>
				        </div>
			        </div>
			        
			    </div>

				<!-- FINAL DESCOMENTAR -->








				
			    <!-- <div class="row g-4 mb-4">
				    <div class="col-12 col-lg-6">
				        <div class="app-card app-card-progress-list h-100 shadow-sm">
					        <div class="app-card-header p-3">
						        <div class="row justify-content-between align-items-center">
							        <div class="col-auto">
						                <h4 class="app-card-title">Por secretaria</h4>
							        </div>
							        <div class="col-auto">
								        <div class="card-header-action">
									        <a href="#">All projects</a>
								        </div>
							        </div>
						        </div>
					        </div>
					        <div class="app-card-body">
							    <div class="item p-3">
								    <div class="row align-items-center">
									    <div class="col">
										    <div class="title mb-1 ">Project lorem ipsum dolor sit amet</div>
										    <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
									    </div>
									    <div class="col-auto">
										    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-chevron-right" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                                            </svg>
									    </div>
								    </div>
								    <a class="item-link-mask" href="#"></a>
							    </div>
							    
							    
							     <div class="item p-3">
								    <div class="row align-items-center">
									    <div class="col">
										    <div class="title mb-1 ">Project duis aliquam et lacus quis ornare</div>
										    <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 34%;" aria-valuenow="34" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
									    </div>
									    <div class="col-auto">
										    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-chevron-right" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                                            </svg>
									    </div>
								    </div>
								    <a class="item-link-mask" href="#"></a>
							    </div>
							    
							    <div class="item p-3">
								    <div class="row align-items-center">
									    <div class="col">
										    <div class="title mb-1 ">Project sed tempus felis id lacus pulvinar</div>
										    <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 68%;" aria-valuenow="68" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
									    </div>
									    <div class="col-auto">
										    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-chevron-right" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                                            </svg>
									    </div>
								    </div>
								    <a class="item-link-mask" href="#"></a>
							    </div>
							    
							    <div class="item p-3">
								    <div class="row align-items-center">
									    <div class="col">
										    <div class="title mb-1 ">Project sed tempus felis id lacus pulvinar</div>
										    <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 52%;" aria-valuenow="52" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
									    </div>
									    <div class="col-auto">
										    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-chevron-right" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                                            </svg>
									    </div>
								    </div>
								    <a class="item-link-mask" href="#"></a>
							    </div>
		
					        </div>
				        </div>
			        </div>
			        <div class="col-12 col-lg-6">
				        <div class="app-card app-card-stats-table h-100 shadow-sm">
					        <div class="app-card-header p-3">
						        <div class="row justify-content-between align-items-center">
							        <div class="col-auto">
						                <h4 class="app-card-title">Porcentual</h4>
							        </div>
							        <div class="col-auto">
								        <div class="card-header-action">
									        <a href="#">View report</a>
								        </div>
							        </div>
						        </div>
					        </div>
					        <div class="app-card-body p-3 p-lg-4">
						        <div class="table-responsive">
							        <table class="table table-borderless mb-0">
										<thead>
											<tr>
												<th class="meta">Source</th>
												<th class="meta stat-cell">Views</th>
												<th class="meta stat-cell">Today</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td><a href="#">google.com</a></td>
												<td class="stat-cell">110</td>
												<td class="stat-cell">
													<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-up text-success" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
									  <path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>
									</svg> 
									                30%
									            </td>
											</tr>
											<tr>
												<td><a href="#">getbootstrap.com</a></td>
												<td class="stat-cell">67</td>
												<td class="stat-cell">23%</td>
											</tr>
											<tr>
												<td><a href="#">w3schools.com</a></td>
												<td class="stat-cell">56</td>
												<td class="stat-cell">
													<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-down text-danger" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                    <path fill-rule="evenodd" d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z"/>
                                                    </svg>
												    20%
											    </td>
											</tr>
											<tr>
												<td><a href="#">javascript.com </a></td>
												<td class="stat-cell">24</td>
												<td class="stat-cell">-</td>
											</tr>
											<tr>
												<td><a href="#">github.com </a></td>
												<td class="stat-cell">17</td>
												<td class="stat-cell">15%</td>
											</tr>
										</tbody>
									</table>
						        </div>
					        </div>
				        </div>
			        </div>
			    </div> -->
			    <!-- <div class="row g-4 mb-4">
				    <div class="col-12 col-lg-4">
					    <div class="app-card app-card-basic d-flex flex-column align-items-start shadow-sm">
						    <div class="app-card-header p-3 border-bottom-0">
						        <div class="row align-items-center gx-3">
							        <div class="col-auto">
								        <div class="app-icon-holder">
										    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-receipt" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M1.92.506a.5.5 0 0 1 .434.14L3 1.293l.646-.647a.5.5 0 0 1 .708 0L5 1.293l.646-.647a.5.5 0 0 1 .708 0L7 1.293l.646-.647a.5.5 0 0 1 .708 0L9 1.293l.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .801.13l.5 1A.5.5 0 0 1 15 2v12a.5.5 0 0 1-.053.224l-.5 1a.5.5 0 0 1-.8.13L13 14.707l-.646.647a.5.5 0 0 1-.708 0L11 14.707l-.646.647a.5.5 0 0 1-.708 0L9 14.707l-.646.647a.5.5 0 0 1-.708 0L7 14.707l-.646.647a.5.5 0 0 1-.708 0L5 14.707l-.646.647a.5.5 0 0 1-.708 0L3 14.707l-.646.647a.5.5 0 0 1-.801-.13l-.5-1A.5.5 0 0 1 1 14V2a.5.5 0 0 1 .053-.224l.5-1a.5.5 0 0 1 .367-.27zm.217 1.338L2 2.118v11.764l.137.274.51-.51a.5.5 0 0 1 .707 0l.646.647.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.509.509.137-.274V2.118l-.137-.274-.51.51a.5.5 0 0 1-.707 0L12 1.707l-.646.647a.5.5 0 0 1-.708 0L10 1.707l-.646.647a.5.5 0 0 1-.708 0L8 1.707l-.646.647a.5.5 0 0 1-.708 0L6 1.707l-.646.647a.5.5 0 0 1-.708 0L4 1.707l-.646.647a.5.5 0 0 1-.708 0l-.509-.51z"/>
                                            <path fill-rule="evenodd" d="M3 4.5a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zm8-6a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5z"/>
                                            </svg>
									    </div>
						                
							        </div>
							        <div class="col-auto">
								        <h4 class="app-card-title">Invoices</h4>
							        </div>
						        </div>
						    </div>
						    <div class="app-card-body px-4">
							    
							    <div class="intro">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam aliquet eros vel diam semper mollis.</div>
						    </div>
						    <div class="app-card-footer p-4 mt-auto">
							   <a class="btn app-btn-secondary" href="#">Create New</a>
						    </div>
						</div>
				    </div>
				    <div class="col-12 col-lg-4">
					    <div class="app-card app-card-basic d-flex flex-column align-items-start shadow-sm">
						    <div class="app-card-header p-3 border-bottom-0">
						        <div class="row align-items-center gx-3">
							        <div class="col-auto">
								        <div class="app-icon-holder">
										    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-code-square" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M14 1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                                            <path fill-rule="evenodd" d="M6.854 4.646a.5.5 0 0 1 0 .708L4.207 8l2.647 2.646a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 0 1 .708 0zm2.292 0a.5.5 0 0 0 0 .708L11.793 8l-2.647 2.646a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708 0z"/>
                                            </svg>
									    </div>
						                
							        </div>
							        <div class="col-auto">
								        <h4 class="app-card-title">Apps</h4>
							        </div>
						        </div>
						    </div>
						    <div class="app-card-body px-4">
							    
							    <div class="intro">Pellentesque varius, elit vel volutpat sollicitudin, lacus quam efficitur augue</div>
						    </div>
						    <div class="app-card-footer p-4 mt-auto">
							   <a class="btn app-btn-secondary" href="#">Create New</a>
						    </div>
						</div>
				    </div>
				    <div class="col-12 col-lg-4">
					    <div class="app-card app-card-basic d-flex flex-column align-items-start shadow-sm">
						    <div class="app-card-header p-3 border-bottom-0">
						        <div class="row align-items-center gx-3">
							        <div class="col-auto">
								        <div class="app-icon-holder">
										    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-tools" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M0 1l1-1 3.081 2.2a1 1 0 0 1 .419.815v.07a1 1 0 0 0 .293.708L10.5 9.5l.914-.305a1 1 0 0 1 1.023.242l3.356 3.356a1 1 0 0 1 0 1.414l-1.586 1.586a1 1 0 0 1-1.414 0l-3.356-3.356a1 1 0 0 1-.242-1.023L9.5 10.5 3.793 4.793a1 1 0 0 0-.707-.293h-.071a1 1 0 0 1-.814-.419L0 1zm11.354 9.646a.5.5 0 0 0-.708.708l3 3a.5.5 0 0 0 .708-.708l-3-3z"/>
                                            <path fill-rule="evenodd" d="M15.898 2.223a3.003 3.003 0 0 1-3.679 3.674L5.878 12.15a3 3 0 1 1-2.027-2.027l6.252-6.341A3 3 0 0 1 13.778.1l-2.142 2.142L12 4l1.757.364 2.141-2.141zm-13.37 9.019L3.001 11l.471.242.529.026.287.445.445.287.026.529L5 13l-.242.471-.026.529-.445.287-.287.445-.529.026L3 15l-.471-.242L2 14.732l-.287-.445L1.268 14l-.026-.529L1 13l.242-.471.026-.529.445-.287.287-.445.529-.026z"/>
                                            </svg>
									    </div>
						                
							        </div>
							        <div class="col-auto">
								        <h4 class="app-card-title">Tools</h4>
							        </div>
						        </div>
						    </div>
						    <div class="app-card-body px-4">
							    
							    <div class="intro">Sed maximus, libero ac pharetra elementum, turpis nisi molestie neque, et tincidunt velit turpis non enim.</div>
						    </div>
						    <div class="app-card-footer p-4 mt-auto">
							   <a class="btn app-btn-secondary" href="#">Create New</a>
						    </div>
						</div>
				    </div>
			    </div> -->
			  
				<script src="/static/plugins/chart.js/chart.min.js"></script> 
<script>
	// Generate charts on load
	window.addEventListener('load', function(){
		var lineChart = document.getElementById('canvas-linechart-chamados').getContext('2d');
		window.myLine = new Chart(lineChart, lineChartConfig);
		
		var barChart = document.getElementById('canvas-barchart').getContext('2d');
		window.myBar = new Chart(barChart, barChartConfig);
		

	});	
    'use strict';

	window.chartColors = {
	green: '#75c181',
	gray: '#a9b5c9',
	text: '#252930',
	border: '#e7e9ed'
	};

	// Dados de chamados

	var semanas = {{ semanas|safe }};
	var dados_abertos = {{ dados_abertos|safe }};
	var dados_fechados = {{ dados_fechados|safe }};
	// DADOS DE UMA SEMANA ATRAS
	var uma_semana = {{uma_semana |safe}}
	var dados_abertos_uma_semana = {{dados_abertos_uma_semana|safe}}
	var dados_fechados_uma_semana = {{dados_fechados_uma_semana|safe}}
	// DADOS DE HOJE
	var hoje = {{hoje |safe}}
	var dados_abertos_hoje = {{dados_abertos_hoje|safe}}
	var dados_fechados_hoje = {{dados_fechados_hoje|safe}}

	// DADOS DE UM MES
	var um_mes_atras = {{um_mes_atras|safe}}
	var dados_abertos_um_mes = {{dados_abertos_um_mes|safe}}
	var dados_fechados_um_mes = {{dados_fechados_um_mes|safe}}

	// DADOS DE UM ANO	
	var meses = {{meses|safe}}
	var dados_abertos_um_ano = {{dados_abertos_um_ano|safe}}
	var dados_fechados_um_ano = {{dados_fechados_um_ano|safe}}

	var count_abertos = {{ count_abertos }};
	var count_fechados = {{ count_fechados }};

	// Dados para o gráfico de barras
	var chamados_por_tipo = {{ chamados_por_tipo|safe }};

	// Chart.js Line Chart Example
	var lineChartConfig = {
		type: 'line',

		data: {
			labels: uma_semana,

			datasets: [{
					label: 'Chamados Abertos',
					fill: false,
					backgroundColor: window.chartColors.green,
					borderColor: window.chartColors.green,
					data: dados_abertos_uma_semana
				}, {
					label: 'Chamados Fechados',
					fill: false,
					backgroundColor: window.chartColors.gray,
					borderColor: window.chartColors.gray,
					data: dados_fechados_uma_semana
				}]
		},
		options: {
			responsive: true,	
			aspectRatio: 1.5,

			legend: {
				display: true,
				position: 'bottom',
				align: 'end',
			},

			title: {
				display: true,
				text: 'Chamados do período de uma semana'
				
			},
			tooltips: {
				mode: 'nearest',
				intersect: true,
				titleMarginBottom: 10,
				bodySpacing: 10,
				xPadding: 16,
				yPadding: 16,
				borderColor: window.chartColors.border,
				borderWidth: 1,
				backgroundColor: '#fff',
				bodyFontColor: window.chartColors.text,
				titleFontColor: window.chartColors.text,

				callbacks: {
					label: function(tooltipItem, data) {
						var datasetLabel = data.datasets[tooltipItem.datasetIndex].label || '';
						var dataPoint = tooltipItem.yLabel;
						return datasetLabel + ': ' + (dataPoint !== undefined ? dataPoint : 0); 
					}
				},

			},
			hover: {
				mode: 'nearest',
				intersect: true
			},
			scales: {
				xAxes: [{
					display: true,
					gridLines: {
						drawBorder: false,
						color: window.chartColors.border,
					},
					scaleLabel: {
						display: true,
						labelString: 'Dias da semana'
					}
				}],
				yAxes: [{
					display: true,
					gridLines: {
						drawBorder: false,
						color: window.chartColors.border,
					},
					scaleLabel: {
						display: true,
						labelString: 'Total de Chamados'
					},
					ticks: {
						beginAtZero: true,
						userCallback: function(value, index, values) {
							return value;
						}
					},
				}]
			}
		}
	};

	// FUNÇÃO PARA ATUALIZAR O GRAFICO DE LINHA DE ACORDO COM A ESCOLHA
	document.getElementById('period-select').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue == '1') {  // HOJE
			myLine.data.labels = hoje;
			myLine.data.datasets[0].data = dados_abertos_hoje;
			myLine.data.datasets[1].data = dados_fechados_hoje;
			myLine.options.title.text = 'Resumo de Chamados para Hoje';
			myLine.options.scales.xAxes[0].scaleLabel.labelString = 'Horas do Dia';
			myLine.options.scales.yAxes[0].scaleLabel.labelString = 'Número Total de Chamados';
		} else if (selectedValue == '2') {  // Esta semana
			myLine.data.labels = uma_semana;
			myLine.data.datasets[0].data = dados_abertos_uma_semana;
			myLine.data.datasets[1].data = dados_fechados_uma_semana;
			myLine.options.title.text = 'Chamados Registrados Esta Semana';
			myLine.options.scales.xAxes[0].scaleLabel.labelString = 'Dias da Semana';
			myLine.options.scales.yAxes[0].scaleLabel.labelString = 'Número Total de Chamados';

		} else if (selectedValue == '3') {  // Este mês
			myLine.data.labels = um_mes_atras;
			myLine.data.datasets[0].data = dados_abertos_um_mes;
			myLine.data.datasets[1].data = dados_fechados_um_mes;
			myLine.options.title.text = 'Chamados Registrados Este Mês';
			myLine.options.scales.xAxes[0].scaleLabel.labelString = 'Semanas do Mês';
			myLine.options.scales.yAxes[0].scaleLabel.labelString = 'Número Total de Chamados';

		} else if(selectedValue == '5') {  // Este ano
			myLine.data.labels = meses;
			myLine.data.datasets[0].data = dados_abertos_um_ano;
			myLine.data.datasets[1].data = dados_fechados_um_ano;
			myLine.options.title.text = 'Análise de Chamados ao Longo do Ano';
			myLine.options.scales.xAxes[0].scaleLabel.labelString = 'Meses do Ano';
			myLine.options.scales.yAxes[0].scaleLabel.labelString = 'Número Total de Chamados';
		}

        // Atualiza o gráfico com os novos dados
        myLine.update();
    });

	// Chart.js Bar Chart Example
	var barChartData = {
		labels: chamados_por_tipo.map(function(item) { return item.tipo; }),
		datasets: [{
			label: 'Quantidade de Chamados por Tipo',
			backgroundColor: window.chartColors.green,
			borderColor: window.chartColors.green,
			borderWidth: 1,
			data: chamados_por_tipo.map(function(item) { return item.quantidade; })
		}]
	};

	var barChartConfig = {
		type: 'bar',
		data: barChartData,
		options: {
			responsive: true,
			aspectRatio: 1.5,

			legend: {
				display: true,
				position: 'bottom',
				align: 'end',
			},

			title: {
				display: false,
				text: 'Quantidade de Chamados por Tipo',
			},
			tooltips: {
				mode: 'index',
				intersect: false,
				titleMarginBottom: 10,
				bodySpacing: 10,
				xPadding: 16,
				yPadding: 16,
				borderColor: window.chartColors.border,
				borderWidth: 1,
				backgroundColor: '#fff',
				bodyFontColor: window.chartColors.text,
				titleFontColor: window.chartColors.text,

				callbacks: {
					label: function(tooltipItem, data) {
						return tooltipItem.yLabel;
					}
				},

			},
			hover: {
				mode: 'nearest',
				intersect: true
			},
			scales: {
				xAxes: [{
					display: true,
					gridLines: {
						drawBorder: false,
						color: window.chartColors.border,
					},
					scaleLabel: {
						display: false,
					}
				}],
				yAxes: [{
					display: true,
					gridLines: {
						drawBorder: false,
						color: window.chartColors.border,
					},
					scaleLabel: {
						display: false,
					},
					ticks: {
						beginAtZero: true,
						userCallback: function(value, index, values) {
							return value;
						}
					},
				}]
			}
		}
	};

</script>
{% endblock %}